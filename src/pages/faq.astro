---
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import type { Lang } from "../lib/data";

const lang: Lang = (Astro.url.searchParams.get("lang") as Lang) || "fr";

const faqs = [
    {
        question: {
            en: "How do I install Cap Player?",
            fr: "Comment installer Cap Player ?",
        },
        answer: {
            en: 'Cap Player is available on iOS, Android, Smart TVs (Samsung, LG, Hisense, Philips), Fire TV, Roku, and Windows. Visit our "How It Works" page for detailed step-by-step installation guides for each platform. For Fire TV, use Downloader app with code 628699. For Roku, visit my.roku.com/account/add/CAPPLAYER.',
            fr: "Cap Player est disponible sur iOS, Android, Smart TV (Samsung, LG, Hisense, Philips), Fire TV, Roku et Windows. Visitez notre page \"Comment √ßa marche\" pour des guides d'installation d√©taill√©s pour chaque plateforme. Pour Fire TV, utilisez l'app Downloader avec le code 628699. Pour Roku, visitez my.roku.com/account/add/CAPPLAYER.",
        },
    },
    {
        question: {
            en: "How do I find my MAC address and PIN?",
            fr: "Comment trouver mon adresse MAC et mon code PIN ?",
        },
        answer: {
            en: 'After installing Cap Player and launching the app, your MAC address and PIN/Device Key will be displayed on the main screen. Select "Login with MAC & Password" option. Take a screenshot or write down these credentials - you\'ll need them when purchasing your subscription.',
            fr: "Apr√®s avoir install√© et lanc√© Cap Player, votre adresse MAC et votre code PIN seront affich√©s sur l'√©cran principal. S√©lectionnez l'option \"Connexion avec MAC & Mot de passe\". Prenez une capture d'√©cran ou notez ces identifiants - vous en aurez besoin lors de l'achat de votre abonnement.",
        },
    },
    {
        question: {
            en: "How many devices can I use?",
            fr: "Combien d'appareils puis-je utiliser ?",
        },
        answer: {
            en: "This depends on your subscription plan. Our 6-month and 12-month plans support 1 device. The 12-month Duo plan supports 2 simultaneous streams on 2 different devices. Each device requires its own MAC address and PIN from Cap Player.",
            fr: "Cela d√©pend de votre forfait d'abonnement. Nos forfaits 6 mois et 12 mois supportent 1 appareil. Le forfait 12 mois Duo supporte 2 flux simultan√©s sur 2 appareils diff√©rents. Chaque appareil n√©cessite sa propre adresse MAC et son PIN depuis Cap Player.",
        },
    },
    {
        question: {
            en: "What channels are included?",
            fr: "Quelles cha√Ænes sont incluses ?",
        },
        answer: {
            en: "We offer over 10,000+ live channels including premium sports (beIN Sports, Canal+, Premier League, Champions League, La Liga), movies, series, news, entertainment, and international channels from around the world. All content is available in HD/4K quality with EPG (Electronic Program Guide) support.",
            fr: "Nous proposons plus de 10 000 cha√Ænes en direct incluant les sports premium (beIN Sports, Canal+, Premier League, Champions League, La Liga), films, s√©ries, actualit√©s, divertissement et cha√Ænes internationales du monde entier. Tout le contenu est disponible en qualit√© HD/4K avec support EPG (Guide √©lectronique des programmes).",
        },
    },
    {
        question: {
            en: "Is there a free trial?",
            fr: "Y a-t-il un essai gratuit ?",
        },
        answer: {
            en: "Yes! All our plans include a 24-hour FREE trial period. You can test all channels, VOD content, and features before being charged. Your payment method will be authorized, but you won't be charged during the trial. Cancel anytime during the 24-hour period with no charge.",
            fr: "Oui ! Tous nos forfaits incluent une p√©riode d'essai GRATUITE de 24 heures. Vous pouvez tester toutes les cha√Ænes, contenus VOD et fonctionnalit√©s avant d'√™tre factur√©. Votre moyen de paiement sera autoris√©, mais vous ne serez pas d√©bit√© pendant l'essai. Annulez √† tout moment pendant les 24 heures sans frais.",
        },
    },
    {
        question: {
            en: "How do I renew my subscription?",
            fr: "Comment renouveler mon abonnement ?",
        },
        answer: {
            en: "Simply purchase a new plan from our pricing page before your current subscription expires. Use the same MAC address and PIN for seamless continuity. Your new subscription will be activated automatically. We recommend renewing at least 48 hours before expiration to avoid any service interruption.",
            fr: "Achetez simplement un nouveau forfait depuis notre page tarifs avant l'expiration de votre abonnement actuel. Utilisez la m√™me adresse MAC et le m√™me PIN pour une continuit√© sans interruption. Votre nouvel abonnement sera activ√© automatiquement. Nous recommandons de renouveler au moins 48 heures avant l'expiration pour √©viter toute interruption de service.",
        },
    },
    {
        question: {
            en: "What payment methods do you accept?",
            fr: "Quels moyens de paiement acceptez-vous ?",
        },
        answer: {
            en: "We accept all major credit and debit cards (Visa, Mastercard), Apple Pay, and Google Pay through our secure Stripe payment processor. All transactions are encrypted and PCI-DSS compliant. Your payment information is never stored on our servers.",
            fr: "Nous acceptons toutes les cartes de cr√©dit et d√©bit majeures (Visa, Mastercard), Apple Pay et Google Pay via notre processeur de paiement s√©curis√© Stripe. Toutes les transactions sont crypt√©es et conformes PCI-DSS. Vos informations de paiement ne sont jamais stock√©es sur nos serveurs.",
        },
    },
    {
        question: {
            en: "How long does activation take?",
            fr: "Combien de temps prend l'activation ?",
        },
        answer: {
            en: "Activation is typically completed within 1-2 hours after payment confirmation. You will receive your activation details via WhatsApp. For immediate assistance or faster activation, contact our support team via WhatsApp at +33 7 58 92 89 01. We're available 24/7.",
            fr: "L'activation est g√©n√©ralement effectu√©e dans les 1-2 heures apr√®s confirmation du paiement. Vous recevrez vos d√©tails d'activation via WhatsApp. Pour une assistance imm√©diate ou une activation plus rapide, contactez notre √©quipe support via WhatsApp au +33 7 58 92 89 01. Nous sommes disponibles 24h/24, 7j/7.",
        },
    },
    {
        question: {
            en: "Can I cancel my subscription?",
            fr: "Puis-je annuler mon abonnement ?",
        },
        answer: {
            en: 'Yes, you can cancel your subscription anytime during the 24-hour trial period with no charge. After the trial, subscriptions are non-refundable as they are for a fixed period (6 or 12 months). <a href="/cancel" class="cancel-link">Click here to access the cancellation form</a>. For assistance, contact us via WhatsApp.',
            fr: 'Oui, vous pouvez annuler votre abonnement √† tout moment pendant la p√©riode d\'essai de 24 heures sans frais. Apr√®s l\'essai, les abonnements ne sont pas remboursables car ils sont pour une p√©riode fixe (6 ou 12 mois). <a href="/cancel" class="cancel-link">Cliquez ici pour acc√©der au formulaire d\'annulation</a>. Pour assistance, contactez-nous via WhatsApp.',
        },
    },
    {
        question: {
            en: "Do you offer refunds?",
            fr: "Offrez-vous des remboursements ?",
        },
        answer: {
            en: "Refunds are available only during the 24-hour free trial period. After the trial ends and your subscription starts, all sales are final and non-refundable. Please test the service thoroughly during your trial period. If you experience technical issues, contact our support team and we'll help resolve them.",
            fr: "Les remboursements sont disponibles uniquement pendant la p√©riode d'essai gratuite de 24 heures. Apr√®s la fin de l'essai et le d√©but de votre abonnement, toutes les ventes sont finales et non remboursables. Veuillez tester le service en profondeur pendant votre p√©riode d'essai. En cas de probl√®mes techniques, contactez notre support qui vous aidera √† les r√©soudre.",
        },
    },
    {
        question: {
            en: "Is my connection secure?",
            fr: "Ma connexion est-elle s√©curis√©e ?",
        },
        answer: {
            en: "Yes! We use industry-standard encryption (SSL/TLS) for all connections. Your payment data is processed through Stripe, a PCI Level 1 certified payment processor. We never store your credit card information. All streams are delivered through secure HTTPS connections.",
            fr: "Oui ! Nous utilisons le cryptage standard de l'industrie (SSL/TLS) pour toutes les connexions. Vos donn√©es de paiement sont trait√©es via Stripe, un processeur de paiement certifi√© PCI Niveau 1. Nous ne stockons jamais vos informations de carte bancaire. Tous les flux sont d√©livr√©s via des connexions HTTPS s√©curis√©es.",
        },
    },
    {
        question: {
            en: "What internet speed do I need?",
            fr: "Quelle vitesse Internet me faut-il ?",
        },
        answer: {
            en: "For optimal streaming experience: SD quality requires 3 Mbps, HD (720p) requires 5 Mbps, Full HD (1080p) requires 8 Mbps, and 4K/UHD requires 25 Mbps. For 2-device Duo plan, ensure you have sufficient bandwidth for multiple streams. We recommend a stable connection for best performance.",
            fr: "Pour une exp√©rience de streaming optimale : La qualit√© SD n√©cessite 3 Mbps, HD (720p) n√©cessite 5 Mbps, Full HD (1080p) n√©cessite 8 Mbps, et 4K/UHD n√©cessite 25 Mbps. Pour le forfait Duo 2 appareils, assurez-vous d'avoir une bande passante suffisante pour plusieurs flux. Nous recommandons une connexion stable pour de meilleures performances.",
        },
    },
];
---

<Layout title="FAQ" lang={lang}>
    <Header lang={lang} />

    <main class="main-content">
        <section class="section">
            <div class="container">
                <!-- Header -->
                <div class="page-header" data-animate>
                    <span class="badge"
                        >‚ùì {
                            lang === "fr" ? "Centre d'Aide" : "Help Center"
                        }</span
                    >
                    <h1>
                        {
                            lang === "fr"
                                ? "Questions Fr√©quentes"
                                : "Frequently Asked Questions"
                        }
                    </h1>
                    <p class="page-subtitle">
                        {
                            lang === "fr"
                                ? "Trouvez des r√©ponses aux questions les plus courantes"
                                : "Find answers to the most common questions"
                        }
                    </p>
                </div>

                <!-- FAQ Accordion -->
                <div class="faq-container">
                    {
                        faqs.map((faq, index) => (
                            <div class="faq-item" data-animate>
                                <button
                                    class="faq-question"
                                    onclick="this.parentElement.classList.toggle('open')"
                                >
                                    <span>{faq.question[lang]}</span>
                                    <svg
                                        class="faq-icon"
                                        width="20"
                                        height="20"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                        stroke="currentColor"
                                        stroke-width="2"
                                    >
                                        <path d="M6 9l6 6 6-6" />
                                    </svg>
                                </button>
                                <div class="faq-answer">
                                    <p set:html={faq.answer[lang]} />
                                </div>
                            </div>
                        ))
                    }
                </div>

                <!-- Still Need Help -->
                <div class="help-card" data-animate>
                    <h3>
                        üí¨ {
                            lang === "fr"
                                ? "Besoin d'aide suppl√©mentaire ?"
                                : "Need more help?"
                        }
                    </h3>
                    <p>
                        {
                            lang === "fr"
                                ? "Notre √©quipe est disponible 24/7 pour r√©pondre √† toutes vos questions"
                                : "Our team is available 24/7 to answer all your questions"
                        }
                    </p>
                    <div class="help-buttons">
                        <a
                            href="https://wa.me/33758928901"
                            target="_blank"
                            rel="noopener noreferrer"
                            class="btn btn-primary"
                        >
                            <span>üí¨</span>
                            WhatsApp
                        </a>
                        <a href="/contact" class="btn btn-secondary">
                            <span>üìß</span>
                            {lang === "fr" ? "Nous contacter" : "Contact Us"}
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <Footer lang={lang} />
</Layout>

<style>
    .page-header {
        text-align: center;
        margin-bottom: 4rem;
    }

    .badge {
        display: inline-block;
        padding: 0.5rem 1rem;
        background: rgba(139, 92, 246, 0.1);
        border: 1px solid rgba(139, 92, 246, 0.2);
        border-radius: 50px;
        color: var(--color-primary);
        font-size: 0.875rem;
        font-weight: 600;
        margin-bottom: 1rem;
    }

    h1 {
        font-size: clamp(2rem, 5vw, 3rem);
        font-weight: 800;
        background: linear-gradient(
            135deg,
            var(--color-text) 0%,
            var(--color-primary) 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 1rem;
    }

    .page-subtitle {
        font-size: 1.125rem;
        color: var(--color-text-muted);
        max-width: 600px;
        margin: 0 auto;
    }

    /* FAQ Accordion */
    .faq-container {
        max-width: 900px;
        margin: 0 auto 4rem;
    }

    .faq-item {
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        border-radius: 16px;
        margin-bottom: 1rem;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .faq-item:hover {
        border-color: rgba(139, 92, 246, 0.3);
    }

    .faq-question {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1.5rem;
        background: none;
        border: none;
        text-align: left;
        cursor: pointer;
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--color-text);
        transition: all 0.3s ease;
    }

    .faq-question:hover {
        color: var(--color-primary);
    }

    .faq-icon {
        flex-shrink: 0;
        transition: transform 0.3s ease;
    }

    .faq-item.open .faq-icon {
        transform: rotate(180deg);
    }

    .faq-answer {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
    }

    .faq-item.open .faq-answer {
        max-height: 500px;
    }

    .faq-answer p {
        padding: 0 1.5rem 1.5rem;
        color: var(--color-text-muted);
        line-height: 1.8;
    }

    /* Cancel Link in FAQ Answer */
    .cancel-link {
        color: #ef4444;
        text-decoration: underline;
        text-decoration-thickness: 2px;
        text-underline-offset: 3px;
        font-weight: 700;
        transition: all 0.3s ease;
    }

    .cancel-link:hover {
        color: #dc2626;
        text-decoration-thickness: 3px;
        text-shadow: 0 0 10px rgba(239, 68, 68, 0.3);
    }

    /* Help Card */
    .help-card {
        text-align: center;
        padding: 3rem 2rem;
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        border-radius: 20px;
        max-width: 700px;
        margin: 4rem auto 0;
    }

    .help-card h3 {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 0.75rem;
    }

    .help-card p {
        color: var(--color-text-muted);
        margin-bottom: 1.5rem;
    }

    .help-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        flex-wrap: wrap;
    }

    @media (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
        }

        .cancellation-section {
            padding: 1.5rem;
        }

        .help-buttons {
            flex-direction: column;
        }
    }
</style>

<script>
    document
        .getElementById("cancel-form")
        ?.addEventListener("submit", async (e) => {
            e.preventDefault();

            const form = e.target as HTMLFormElement;
            const messageDiv = document.getElementById("cancel-message");
            const submitBtn = form.querySelector(
                'button[type="submit"]',
            ) as HTMLButtonElement;

            if (!messageDiv) return;

            // Disable submit button
            submitBtn.disabled = true;
            submitBtn.textContent = "Envoi en cours...";

            const formData = new FormData(form);
            const data = {
                email: formData.get("email"),
                mac: formData.get("mac"),
                reason: formData.get("reason") || "No reason provided",
                timestamp: new Date().toISOString(),
            };

            try {
                // Send WhatsApp notification (you can also send to your backend)
                const message = `üö´ CANCELLATION REQUEST\n\nEmail: ${data.email}\nMAC: ${data.mac}\nReason: ${data.reason}\nTime: ${data.timestamp}`;

                // Show success message
                messageDiv.style.display = "block";
                messageDiv.className = "form-message success";
                messageDiv.textContent =
                    "‚úÖ Demande envoy√©e ! Notre √©quipe vous contactera sous 24h.";

                // Reset form
                form.reset();

                // Optional: Send to WhatsApp (this would open WhatsApp)
                // window.open(`https://wa.me/33758928901?text=${encodeURIComponent(message)}`, '_blank');
            } catch (error) {
                messageDiv.style.display = "block";
                messageDiv.className = "form-message error";
                messageDiv.textContent =
                    "‚ùå Erreur lors de l'envoi. Veuillez r√©essayer ou nous contacter via WhatsApp.";
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML =
                    '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>Soumettre la demande d\'annulation';
            }
        });
</script>
